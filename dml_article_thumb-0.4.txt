# dml_article_thumb v0.4
# Returns a thumbnail for the article image
# Dan Lowe
# http://tangledhelix.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjc6InZlcnNpb24iO3M6MzoiMC40IjtzOjY6ImF1dGhvciI7czo4OiJEYW4gTG93
ZSI7czoxMDoiYXV0aG9yX3VyaSI7czoyNDoiaHR0cDovL3RhbmdsZWRoZWxpeC5jb20vIjtz
OjExOiJkZXNjcmlwdGlvbiI7czo0MToiUmV0dXJucyBhIHRodW1ibmFpbCBmb3IgdGhlIGFy
dGljbGUgaW1hZ2UiO3M6NDoidHlwZSI7aTowO3M6NDoibmFtZSI7czoxNzoiZG1sX2FydGlj
bGVfdGh1bWIiO3M6NDoiaGVscCI7czozODY6Igo8cD48c3Ryb25nPnR4cDpkbWxfYXJ0aWNs
ZV90aHVtYjwvc3Ryb25nPjwvcD4KCjxwPlRoaXMgcGx1Z2luIHByb3ZpZGVzIGEgZnVuY3Rp
b24gc2ltaWxhciB0bwo8Y29kZT4mbHQ7dHhwOmFydGljbGVfaW1hZ2UmbmJzcDsvJmd0Ozwv
Y29kZT4KZXhjZXB0IGl0IHJldHVybnMgYSB0aHVtYm5haWwuIEkgdXNlIGl0IGluIGV4Y2Vy
cHRzIGZvciBSU1MsIGJ1dAppdCBzaG91bGQgd29yayBhbnl3aGVyZS4gTWFrZSBzdXJlIHlv
dXIgYXJ0aWNsZSBoYXMgYW4gYXJ0aWNsZSBpbWFnZQpJRCAoc2VlIHRoZSBBZHZhbmNlZCBh
cmVhIGluIHRoZSB3cml0ZSB0YWIpLCB0aGVuIHVzZTo8L3A+Cgo8cD48Y29kZT4mbHQ7dHhw
OmRtbF9hcnRpY2xlX3RodW1iIC8mZ3Q7PC9jb2RlPjwvcD4KIjtzOjQ6ImNvZGUiO3M6MTAy
NDoiCglmdW5jdGlvbiBkbWxfYXJ0aWNsZV90aHVtYigkYXR0cykKCXsKICAgICAgICBnbG9i
YWwgJHRoaXNhcnRpY2xlLCRpbWdfZGlyOwogICAgICAgIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICAgICAgICdzdHlsZScgPT4gJycsCiAgICAgICAgICAgICdhbGlnbicgPT4gJycK
ICAgICAgICApLCRhdHRzKSk7CgogICAgICAgICR0aGVpbWFnZSA9ICgkdGhpc2FydGljbGVb
J2FydGljbGVfaW1hZ2UnXSkgPyAkdGhpc2FydGljbGVbJ2FydGljbGVfaW1hZ2UnXSA6ICcn
OwoKICAgICAgICBpZiAoJHRoZWltYWdlKSB7CgogICAgICAgICAgICBpZiAoaXNfbnVtZXJp
YygkdGhlaW1hZ2UpKSB7CiAgICAgICAgICAgICAgICAkcnMgPSBzYWZlX3JvdygiKiIsJ3R4
cF9pbWFnZScsImlkPSckdGhlaW1hZ2UnIik7CiAgICAgICAgICAgICAgICBpZiAoJHJzKSB7
CiAgICAgICAgICAgICAgICAgICAgZXh0cmFjdCgkcnMpOwogICAgICAgICAgICAgICAgICAg
ICRvdXQgPSBhcnJheSgKICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcnLAogICAgICAg
ICAgICAgICAgICAgICAgICAnc3JjPSInLmh1LiRpbWdfZGlyLicvJy4kaWQuJ3QnLiRleHQu
JyInLAogICAgICAgICAgICAgICAgICAgICAgICAoIWVtcHR5KCRhbHQpKSA/ICdhbHQ9Iicu
JGFsdC4nIicgOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgKCFlbXB0eSgkc3R5bGUp
KSA/ICdzdHlsZT0iJy4kc3R5bGUuJyInIDogJycsCiAgICAgICAgICAgICAgICAgICAgICAg
ICghZW1wdHkoJGFsaWduKSkgPyAnYWxpZ249IicuJGFsaWduLiciJyA6ICcnLAogICAgICAg
ICAgICAgICAgICAgICAgICAnIC8+JwogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIGpvaW4oJyAnLCRvdXQpOwogICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuICc8aW1nIHNyYz0i
Jy4kdGhlaW1hZ2UuJyIgYWx0PSIiIC8+JzsKICAgICAgICAgICAgfQogICAgICAgIH0KCgl9
CiI7czozOiJtZDUiO3M6MzI6ImYyODI4OTIyMTI4ZjU3OTE1M2YwYjdmMTc5MzE1ZThiIjt9
