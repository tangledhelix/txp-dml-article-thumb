# dml_article_thumb v0.5
# Returns a thumbnail for the article image
# Dan Lowe
# http://tangledhelix.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjc6InZlcnNpb24iO3M6MzoiMC41IjtzOjY6ImF1dGhvciI7czo4OiJEYW4gTG93
ZSI7czoxMDoiYXV0aG9yX3VyaSI7czoyNDoiaHR0cDovL3RhbmdsZWRoZWxpeC5jb20vIjtz
OjExOiJkZXNjcmlwdGlvbiI7czo0MToiUmV0dXJucyBhIHRodW1ibmFpbCBmb3IgdGhlIGFy
dGljbGUgaW1hZ2UiO3M6NDoidHlwZSI7aTowO3M6NDoibmFtZSI7czoxNzoiZG1sX2FydGlj
bGVfdGh1bWIiO3M6NDoiaGVscCI7czozODY6Igo8cD48c3Ryb25nPnR4cDpkbWxfYXJ0aWNs
ZV90aHVtYjwvc3Ryb25nPjwvcD4KCjxwPlRoaXMgcGx1Z2luIHByb3ZpZGVzIGEgZnVuY3Rp
b24gc2ltaWxhciB0bwo8Y29kZT4mbHQ7dHhwOmFydGljbGVfaW1hZ2UmbmJzcDsvJmd0Ozwv
Y29kZT4KZXhjZXB0IGl0IHJldHVybnMgYSB0aHVtYm5haWwuIEkgdXNlIGl0IGluIGV4Y2Vy
cHRzIGZvciBSU1MsIGJ1dAppdCBzaG91bGQgd29yayBhbnl3aGVyZS4gTWFrZSBzdXJlIHlv
dXIgYXJ0aWNsZSBoYXMgYW4gYXJ0aWNsZSBpbWFnZQpJRCAoc2VlIHRoZSBBZHZhbmNlZCBh
cmVhIGluIHRoZSB3cml0ZSB0YWIpLCB0aGVuIHVzZTo8L3A+Cgo8cD48Y29kZT4mbHQ7dHhw
OmRtbF9hcnRpY2xlX3RodW1iIC8mZ3Q7PC9jb2RlPjwvcD4KIjtzOjQ6ImNvZGUiO3M6OTYx
OiIKZnVuY3Rpb24gZG1sX2FydGljbGVfdGh1bWIoJGF0dHMpCnsKICAgIGdsb2JhbCAkdGhp
c2FydGljbGUsICRpbWdfZGlyOwogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAn
c3R5bGUnID0+ICcnLAogICAgICAgICdhbGlnbicgPT4gJycKICAgICksJGF0dHMpKTsKCiAg
ICAkdGhlaW1hZ2UgPSAoJHRoaXNhcnRpY2xlWydhcnRpY2xlX2ltYWdlJ10pCiAgICAgICAg
ICAgICAgICAgICAgICAgID8gJHRoaXNhcnRpY2xlWydhcnRpY2xlX2ltYWdlJ10KICAgICAg
ICAgICAgICAgICAgICAgICAgOiAnJzsKCiAgICBpZiAoJHRoZWltYWdlKQogICAgewogICAg
ICAgIGlmIChpc19udW1lcmljKCR0aGVpbWFnZSkpCiAgICAgICAgewogICAgICAgICAgICAk
cnMgPSBzYWZlX3JvdygnKicsICd0eHBfaW1hZ2UnLCAiaWQ9JyR0aGVpbWFnZSciKTsKICAg
ICAgICAgICAgaWYgKCRycykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZXh0cmFj
dCgkcnMpOwogICAgICAgICAgICAgICAgJG91dCA9ICc8aW1nIHNyYz0iJy4gaHUgLiAiJGlt
Z19kaXIvJHtpZH10JGV4dFwiIjsKCiAgICAgICAgICAgICAgICBpZiAoIWVtcHR5KCRhbHQp
KSAgICRvdXQgLj0gJyBhbHQ9IicgICAuICRhbHQgICAuICciJzsKICAgICAgICAgICAgICAg
IGlmICghZW1wdHkoJHN0eWxlKSkgJG91dCAuPSAnIHN0eWxlPSInIC4gJHN0eWxlIC4gJyIn
OwogICAgICAgICAgICAgICAgaWYgKCFlbXB0eSgkYWxpZ24pKSAkb3V0IC49ICcgYWxpZ249
IicgLiAkYWxpZ24gLiAnIic7CgogICAgICAgICAgICAgICAgJG91dCAuPSAnIC8+JzsKCiAg
ICAgICAgICAgICAgICByZXR1cm4gJG91dDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg
ICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gJzxpbWcgc3JjPSInIC4g
JHRoZWltYWdlIC4gJyIgYWx0PSIiIC8+JzsKICAgICAgICB9CiAgICB9Cn0KIjtzOjM6Im1k
NSI7czozMjoiMGVmYzZlNDE0NjY2NTcxNjBiMDI1NWQ4ZDI5NDM3YTQiO30=
