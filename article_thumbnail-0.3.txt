# article_thumbnail v0.3
# Returns a thumbnail for the article image
# Dan Lowe
# http://tangledhelix.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjc6InZlcnNpb24iO3M6MzoiMC4zIjtzOjY6ImF1dGhvciI7czo4OiJEYW4gTG93
ZSI7czoxMDoiYXV0aG9yX3VyaSI7czoyNDoiaHR0cDovL3RhbmdsZWRoZWxpeC5jb20vIjtz
OjExOiJkZXNjcmlwdGlvbiI7czo0MToiUmV0dXJucyBhIHRodW1ibmFpbCBmb3IgdGhlIGFy
dGljbGUgaW1hZ2UiO3M6NDoidHlwZSI7aTowO3M6NDoibmFtZSI7czoxNzoiYXJ0aWNsZV90
aHVtYm5haWwiO3M6NDoiaGVscCI7czozODY6Igo8cD48c3Ryb25nPnR4cDphcnRpY2xlX3Ro
dW1ibmFpbDwvc3Ryb25nPjwvcD4KCjxwPlRoaXMgcGx1Z2luIHByb3ZpZGVzIGEgZnVuY3Rp
b24gc2ltaWxhciB0bwo8Y29kZT4mbHQ7dHhwOmFydGljbGVfaW1hZ2UmbmJzcDsvJmd0Ozwv
Y29kZT4KZXhjZXB0IGl0IHJldHVybnMgYSB0aHVtYm5haWwuIEkgdXNlIGl0IGluIGV4Y2Vy
cHRzIGZvciBSU1MsIGJ1dAppdCBzaG91bGQgd29yayBhbnl3aGVyZS4gTWFrZSBzdXJlIHlv
dXIgYXJ0aWNsZSBoYXMgYW4gYXJ0aWNsZSBpbWFnZQpJRCAoc2VlIHRoZSBBZHZhbmNlZCBh
cmVhIGluIHRoZSB3cml0ZSB0YWIpLCB0aGVuIHVzZTo8L3A+Cgo8cD48Y29kZT4mbHQ7dHhw
OmFydGljbGVfdGh1bWJuYWlsIC8mZ3Q7PC9jb2RlPjwvcD4KIjtzOjQ6ImNvZGUiO3M6MTAy
NDoiCglmdW5jdGlvbiBhcnRpY2xlX3RodW1ibmFpbCgkYXR0cykKCXsKICAgICAgICBnbG9i
YWwgJHRoaXNhcnRpY2xlLCRpbWdfZGlyOwogICAgICAgIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICAgICAgICdzdHlsZScgPT4gJycsCiAgICAgICAgICAgICdhbGlnbicgPT4gJycK
ICAgICAgICApLCRhdHRzKSk7CgogICAgICAgICR0aGVpbWFnZSA9ICgkdGhpc2FydGljbGVb
J2FydGljbGVfaW1hZ2UnXSkgPyAkdGhpc2FydGljbGVbJ2FydGljbGVfaW1hZ2UnXSA6ICcn
OwoKICAgICAgICBpZiAoJHRoZWltYWdlKSB7CgogICAgICAgICAgICBpZiAoaXNfbnVtZXJp
YygkdGhlaW1hZ2UpKSB7CiAgICAgICAgICAgICAgICAkcnMgPSBzYWZlX3JvdygiKiIsJ3R4
cF9pbWFnZScsImlkPSckdGhlaW1hZ2UnIik7CiAgICAgICAgICAgICAgICBpZiAoJHJzKSB7
CiAgICAgICAgICAgICAgICAgICAgZXh0cmFjdCgkcnMpOwogICAgICAgICAgICAgICAgICAg
ICRvdXQgPSBhcnJheSgKICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcnLAogICAgICAg
ICAgICAgICAgICAgICAgICAnc3JjPSInLmh1LiRpbWdfZGlyLicvJy4kaWQuJ3QnLiRleHQu
JyInLAogICAgICAgICAgICAgICAgICAgICAgICAoIWVtcHR5KCRhbHQpKSA/ICdhbHQ9Iicu
JGFsdC4nIicgOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgKCFlbXB0eSgkc3R5bGUp
KSA/ICdzdHlsZT0iJy4kc3R5bGUuJyInIDogJycsCiAgICAgICAgICAgICAgICAgICAgICAg
ICghZW1wdHkoJGFsaWduKSkgPyAnYWxpZ249IicuJGFsaWduLiciJyA6ICcnLAogICAgICAg
ICAgICAgICAgICAgICAgICAnIC8+JwogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIGpvaW4oJyAnLCRvdXQpOwogICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuICc8aW1nIHNyYz0i
Jy4kdGhlaW1hZ2UuJyIgYWx0PSIiIC8+JzsKICAgICAgICAgICAgfQogICAgICAgIH0KCgl9
CiI7czozOiJtZDUiO3M6MzI6Ijk4NzEyNDU5YzE3ZDkwY2VlZTM0MjNjNDNlOGRmZjRhIjt9
